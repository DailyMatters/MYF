*Symfony is a reusable set of standalone, decoupled and cohesive PHP components that solve common web development problems.*

Instead of creating a framework from scratch, we will write the same application over and over again, adding layers of complexity as we go. We're starting with the simplest PHP application we can think of:

```PHP
// framework/index.php
$input = $_GET['name'];

printf('Hello %s', $input);
```

Then we can use the PHP in built server to test this code:

```bash
php -S 127.0.0.1:4321
```

 `http://localhost:4321/index.php?name=Claudio`, check it on the browser.

#### The HTTPFoundation component

The HTTP specification describes how a client (a browser for instance) interacts with a server (our application via a web server). The dialog between the client and the server is specified by well-defined messages, requests and responses: the client sends a request to the server and based on this request, the server returns a response.

In PHP, the request is represented by global variables ($_GET, $_POST, $_FILE, $_COOKIE, $_SESSION...) and the response is generated by functions (echo, header, setcookie, ...).

The first step towards better code is probably to use an Object-Oriented approach; that's the main goal of the Symfony HttpFoundation component: replacing the default PHP global variables and functions by an Object-Oriented layer.

**HTTPFoundation: defines an object oriented layer for the HTTP specification.**

```bash
composer require symfony/http-foundation
```

We are now able to rewrite our application using the `Request` and `Response` classes.

```php
// framework/index.php
require_once __DIR__.'/vendor/autoload.php';

use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;

$request = Request::createFromGlobals();

$input = $request->get('name', 'World');

$response = new Response(sprintf('Hello %s', htmlspecialchars($input, ENT_QUOTES, 'UTF-8')));

$response->send();
```
#### Front Controller
What happens when we want to add a new page? We're going to start having repeated code that we'll need to separate. For that we create a single point of entry: a front controller.

*Exposing a single PHP script to the end user is a design pattern called the 'front controller'.*

```php
// framework/front.php
require_once __DIR__.'/vendor/autoload.php';

use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;

$request = Request::createFromGlobals();
$response = new Response();

$map = array(
    '/hello' => __DIR__.'/hello.php',
    '/bye'   => __DIR__.'/bye.php',
);

$path = $request->getPathInfo();
if (isset($map[$path])) {
    require $map[$path];
} else {
    $response->setStatusCode(404);
    $response->setContent('Not Found');
}

$response->send();
```
and the hello.php script:

```php
// framework/hello.php
$input = $request->get('name', 'World');
$response->setContent(sprintf('Hello %s', htmlspecialchars($input, ENT_QUOTES, 'UTF-8')));
```

Using the in built PHP server just as earlier we can acess the following url's:

http://127.0.0.1:4321/front.php/hello?name=Claudio

http://127.0.0.1:4321/front.php/bye

#### Routing

One very important aspect of any website is the form of its URLs. Thanks to the URL map, we have decoupled the URL from the code that generates the associated response, but it is not yet flexible enough. For instance, we might want to support dynamic paths to allow embedding data directly into the URL (e.g. /hello/Claudio) instead of relying on a query string (e.g. /hello?name=Claudio).

To support this feature, add the Symfony Routing component as a dependency:

```bash
composer require symfony/routing
```

**Routing: Maps an HTTP request to a set of of configuration variables.**

```php
// example.com/web/front.php
require_once __DIR__.'/../vendor/autoload.php';

use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing;

$request = Request::createFromGlobals();
$routes = include __DIR__.'/../src/app.php';

$context = new Routing\RequestContext();
$context->fromRequest($request);
$matcher = new Routing\Matcher\UrlMatcher($routes, $context);

try {
    extract($matcher->match($request->getPathInfo()), EXTR_SKIP);
    ob_start();
    include sprintf(__DIR__.'/../src/pages/%s.php', $_route);

    $response = new Response(ob_get_clean());
} catch (Routing\Exception\ResourceNotFoundException $e) {
    $response = new Response('Not Found', 404);
} catch (Exception $e) {
    $response = new Response('An error occurred', 500);
}

$response->send();
```

Our hello.php template:

```php
Hello <?php echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8') ?>
```

and finnaly our app.php, which contains all of our routes now:

```php
use Symfony\Component\Routing;

$routes = new Routing\RouteCollection();
$routes->add('hello', new Routing\Route('/hello/{name}', array('name' => 'World')));
$routes->add('bye', new Routing\Route('/bye'));

return $routes;
```
